const VDF = require('./VDF');

class Depot extends VDF
{
    constructor (depot_id)
    {
        super();
        this._depot_id       = depot_id;
        this._content_root   = `../depots/${depot_id}`;
        this._file_mapping   = [];
        this._file_exclusion = [];
    }

    get depot_id ()
    {
        return this._depot_id;
    }

    get content_root ()
    {
        return this._content_root;
    }

    get file_mapping ()
    {
        return new Proxy(this._file_mapping, {
            set: function (target, property, value) {
                target[property] = value;
                return true;
            },
            get: function (target, property) {
                if (typeof target[property] === 'boolean') {
                    return target[property] ? '1' : '0';
                }

                return target[property];
            }
        });
    }

    get file_exclusion ()
    {
        return this._file_exclusion;
    }

    addFileMapping (src, dest, recursive)
    {
        const file_mapping     = {};
        file_mapping.localPath = src;
        file_mapping.depotPath = dest;
        file_mapping.recursive = recursive;
        this._file_mapping.push(file_mapping);
    }

    addFilePattern (pattern)
    {

    }
}

module.exports = Depot;